# Story 8.5: Pipeline Integration

## Goal

Wire the pipeline sidebar into the preview pane, replacing the folder browser. Update the content hook to work with active content from the pipeline. Delete the old folder browser.

## Dependencies

- Story 8.4 (pipeline sidebar UI)

## Files to Edit

```
src/renderer/components/preview-pane.tsx       # Replace FolderBrowser with PipelineSidebar
src/renderer/hooks/use-content.ts             # Accept activeContentDir override
```

## Files to Delete

```
src/renderer/components/folder-browser.tsx     # Replaced by PipelineSidebar
```

## Changes

### preview-pane.tsx

- Remove FolderBrowser import
- Import PipelineSidebar and usePipeline
- Replace `<FolderBrowser>` with `<PipelineSidebar>`
- **Remove Library tab** — pipeline sidebar IS the library (merged from Story 6.1)
- Tabs become: `['Content', 'Components']` only
- Sidebar width: `w-72` (288px, up from 224px)
- When pipeline item is activated:
  1. Files from that content's directory render in the preview area
  2. Use `contentDir` from the active PipelineItem
  3. The useContent hook reads files from the active content directory
- When no item is active: show "Select content to preview" empty state

### use-content.ts

- Accept optional `activeContentDir?: string` parameter
- When set, override the default contentDir for file reading
- The `selectFile`, `read`, and `listVersions` calls use the active directory
- File watcher events are already handled by the main process switching watchers

### Wiring

```
PipelineSidebar (left, w-72)
  → user clicks card
  → usePipeline.activateItem(item)
  → IPC pipeline:activate (PTY cd, watcher restart)
  → useContent receives new activeContentDir
  → preview area shows files from active content
```

## Backward Compatibility

- Existing content without metadata.json still appears in sidebar (auto-detected)
- Content read/version IPC handlers unchanged
- ContentRenderer unchanged

## Acceptance Criteria

- [ ] FolderBrowser completely replaced by PipelineSidebar
- [ ] folder-browser.tsx deleted
- [ ] Library tab removed (tabs: Content, Components only)
- [ ] Clicking pipeline item shows its files in preview
- [ ] Preview updates when content files change
- [ ] No references to deleted FolderBrowser remain
- [ ] All checks pass: lint, typecheck, build
